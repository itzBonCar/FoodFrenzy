#### Run application locally

Create a Mysql connection
Run the mysql server locally by starting the MySQL80 service which can be found in Services settings. Use it to manually turn on/off the service
mysql -u root -p    # to access db using cli, if host and port different ,mysql -h localhost -P 3306 -u root -p
      CREATE DATABASE food_frenzy_db;
      USE food_frenzy_db;
      SELECT COUNT(*) FROM table_name;
      SHOW TABLES;
      INSERT INTO users (username, email) VALUES ('john', 'john@example.com');
      SELECT id, username FROM users;
      SELECT * FROM users WHERE id = 1;
      QUIT;

      NOTE: Check service, ps aux | grep mysql
            Check port, lsof -i :3306

Now link it to your application by configuring it in FoodFrenzy\src\main\resources\application.properties
Setup .env file with env vars for spring properties in application.properties and env vars for docker-compose mysql container
NOW, Build and run the application locally
mvn clean install -DskipTests # to build the project
set -a
source .env     # do this to use the .env vars
set +a
./mvnw spring-boot:run OR java -jar app.jar
NOW, open the app on http://localhost:8080 locally


#### Dockerize the application by creating Docker image using Dockerfile
Build the image with the following command and then run docker container for it

$ docker build -t foodfrenzyimage:v01 .

$ docker run --name foodfrenzycontainer8 -d -p 9090:8080 -e SPRING_DATASOURCE_URL=jdbc:mysql://host.docker.internal:3306/food_frenzy_db -e SPRING_DATASOURCE_USERNAME=root -e SPRING_DATASOURCE_PASSWORD=carbon123 foodfrenzyimage:v01

Above command used db that is locally hosted. But to have our db run inside a container we need docker-compose.yml and run the db container along with app container

Created docker-compose.yml with 2 containers mysql and application
Had to choose right mysql version to make sure the already loaded mysqldump.sql runs at dockerentrypoint.db


### CREATING CUSTOM MYSQL IMAGE WITH DUMP ADDED (not preferred). ALso push it onto dockerhub
create Dockerfile.mysql (2nd Dockerfile)

Pass secrets at runtime or create .env file(check next section)
docker run -d \
  --name mysqlsecure \
  -e MYSQL_ROOT_PASSWORD=carbon123 \
  -e MYSQL_DATABASE=food_frenzy_db \
  -e MYSQL_USER=carbon \
  -e MYSQL_PASSWORD=carbon123 \
  itzboncar/food_frenzy_mysql:latest

### PUSH it to DOCKERHUB Account itzboncar
    $ docker build -f Dockerfile.mysql -t food_frenzy_mysql:latest .
    $ docker login
    $ docker tag food_frenzy_mysql:latest itzboncar/food_frenzy_mysql:latest
    $ docker push itzboncar/food_frenzy_mysql:latest

### Docker-compose pulls env vars from .env file (which is not supposed to be loaded onto github)
create and load .env file with secrets

$ docker-compose up -d --build

If .env file in different folder
$ docker-compose up --env-file ./config/myenv -d --build

Also,
$ docker-compose down -v (remove volumes too, wipes db)
$ docker-compose down --rmi all (removes all images)


.env is put in gitignore

### DEPLOY TO LOCAL K8S cluster



##### NEXT GOALS:
Send Mail if pipeline fails
Make it secure
create helm chart
create terraform script
Use Ansible
